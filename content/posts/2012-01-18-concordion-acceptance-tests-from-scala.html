---
layout: post
title: Concordion acceptance tests from Scala
date: '2012-01-18T02:11:00.000-08:00'
author: Stephen Nancekivell
tags: 
modified_time: '2012-01-22T12:26:29.641-08:00'
blogger_id: tag:blogger.com,1999:blog-2519344180739427574.post-386634052453298735
blogger_orig_url: http://blog.stephenn.com/2012/01/concordion-acceptance-tests-from-scala.html
---

<a href="http://concordion.org/">Concordion</a> is a great test automation framework written in&nbsp;Java. <a href="http://www.scala-lang.org/">Scala</a> is a great functional programming language which runs on the JVM. Scala can easily use&nbsp;Java&nbsp;code, which makes using&nbsp;Concordion&nbsp;from&nbsp;Scala&nbsp;very simple.<br /><br />However there was one feature of Concordion that gave us some trouble. Java&nbsp;Concordion fixtures can return objects with public variables that Concordion can use to make assertions. But in Scala you cant really create public class variables.&nbsp;Scala creates public getter and setter methods with the name of the variable and keeps the variable private. This is all done under the hood of Scala so you&nbsp;don't&nbsp;notice it. Now when the Java code of Concordion tries to access those variables it instead finds the getter / setter methods and fails to make the assertion, throwing a very confusing error having found the method of the name of the variable that you were expecting.<br /><br />Heres an example of the Concordion spec from the <a href="http://www.concordion.org/Tutorial.html">Concordion tutorial page</a>, which calls the "split()" method returning the "result" object which has the public variables "firstName" and "lastName". This works fine from Java.<br /><blockquote class="tr_bq"><span style="color: black;"><a href="http://www.blogger.com/blogger.g?blogID=2519344180739427574" name="executeObjectResult" style="background-color: #fcfcfa; font-family: Arial, Helvetica, SansSerif; line-height: 18px;"></a></span><br /><pre class="html" style="background-color: #ffffd9; border-bottom-color: rgb(237, 237, 223); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(237, 237, 223); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(237, 237, 223); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(237, 237, 223); border-top-style: solid; border-top-width: 1px; font-family: 'Courier New', Courier, Fixed; margin-left: 40px; padding-bottom: 8px; padding-left: 8px; padding-right: 8px; padding-top: 8px;"><span style="color: black; font-size: x-small;">&lt;span <b>concordion:execute="#result = split(#TEXT)"</b>&gt;John Smith&lt;/span&gt;<br />                will be broken into first name<br />                &lt;span <b>concordion:assertEquals="#result.firstName"</b>&gt;John&lt;/span&gt;<br />                and last name<br />                &lt;span <b>concordion:assertEquals="#result.lastName"</b>&gt;Smith&lt;/span&gt;.</span></pre><a href="http://www.blogger.com/blogger.g?blogID=2519344180739427574" name="executeObjectResult" style="background-color: #fcfcfa; font-family: Arial, Helvetica, SansSerif; line-height: 18px;"></a></blockquote>As a work around to this problem the&nbsp;<a class="externalLink homepage" href="https://github.com/tom/accordion-scala" style="background-attachment: initial; background-clip: initial; background-color: #fcfcfa; background-image: url(http://www.concordion.org/image/shared/ExternalLink.png); background-origin: initial; background-position: 100% 50%; background-repeat: no-repeat no-repeat; font-family: Arial, Helvetica, SansSerif; line-height: 23px; padding-right: 12px;">accordion-scala</a>&nbsp;project was created by&nbsp;<span style="background-color: #fcfcfa;"><span style="font-family: Arial, Helvetica, SansSerif;"><span style="line-height: 18px;">Tom Malone and is supported by the&nbsp;Concordion&nbsp;creates linking to it from the Concordion website.</span></span></span><br /><span style="background-color: #fcfcfa; font-family: Arial, Helvetica, SansSerif; line-height: 18px;"><br /></span><br /><span style="font-family: Arial, Helvetica, SansSerif;"><span style="line-height: 18px;">However my&nbsp;collogue, <a href="https://plus.google.com/101979635857997532499/posts">Jun Yamog</a>, a true Scala guru, thought of a much&nbsp;simpler&nbsp;solution.</span></span><br /><span style="font-family: Arial, Helvetica, SansSerif;"><span style="line-height: 18px;"><br /></span></span><br /><span style="font-family: Arial, Helvetica, SansSerif;"><span style="line-height: 18px;">In the concordion fixture you can specify that the object value that your accessing is in fact a method, and it should be treated as such by simply adding the&nbsp;parenthesise&nbsp;to the end of the call, like so.</span></span><br /><blockquote class="tr_bq"><a href="http://www.blogger.com/blogger.g?blogID=2519344180739427574" name="executeObjectResult" style="background-color: #fcfcfa;"></a><br /><pre class="html" style="background-color: #ffffd9; border-bottom-color: rgb(237, 237, 223); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(237, 237, 223); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(237, 237, 223); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(237, 237, 223); border-top-style: solid; border-top-width: 1px; margin-left: 40px; padding-bottom: 8px; padding-left: 8px; padding-right: 8px; padding-top: 8px;"><span style="font-size: x-small;"><span style="font-family: 'Courier New', Courier, Fixed;"><span style="line-height: 18px;">&lt;span </span></span><b style="font-family: 'Courier New', Courier, Fixed; line-height: 18px;">concordion:execute="#result = split(#TEXT)"</b><span style="font-family: 'Courier New', Courier, Fixed;"><span style="line-height: 18px;">&gt;John Smith&lt;/span&gt;<br />                will be broken into first name<br />                &lt;span </span></span><b style="font-family: 'Courier New', Courier, Fixed; line-height: 18px;">concordion:assertEquals="#result.firstName()"</b><span style="font-family: 'Courier New', Courier, Fixed;"><span style="line-height: 18px;">&gt;John&lt;/span&gt;<br />                and last name<br />                &lt;span </span></span><b style="font-family: 'Courier New', Courier, Fixed; line-height: 18px;">concordion:assertEquals="#result.lastName()"</b><span style="font-family: 'Courier New', Courier, Fixed;"><span style="line-height: 18px;">&gt;Smith&lt;/span&gt;.</span></span></span></pre><a href="http://www.blogger.com/blogger.g?blogID=2519344180739427574" name="executeObjectResult" style="background-color: #fcfcfa;"></a></blockquote>Which will work with the following Scala case class.<br /><blockquote class="tr_bq"><a href="http://www.blogger.com/blogger.g?blogID=2519344180739427574" name="executeObjectResult" style="background-color: #fcfcfa;"></a><br /><pre class="html" style="background-color: #ffffd9; border-bottom-color: rgb(237, 237, 223); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(237, 237, 223); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(237, 237, 223); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(237, 237, 223); border-top-style: solid; border-top-width: 1px; margin-left: 40px; padding-bottom: 8px; padding-left: 8px; padding-right: 8px; padding-top: 8px;"><span style="font-family: 'Courier New', Courier, Fixed; font-size: x-small;"><span style="line-height: 18px;">case class result(firstName: String, lastName: String)</span></span></pre><a href="http://www.blogger.com/blogger.g?blogID=2519344180739427574" name="executeObjectResult" style="background-color: #fcfcfa;"></a></blockquote><br /><br />This is a&nbsp;ridiculously&nbsp; subtle work around, using the Scala generated getter/setter methods from&nbsp;Concordion&nbsp;in a way that was not documented to be possible.&nbsp;Thus the use of the accordion-scala port can be avoided.<br /><br />For some complete code examples checkout this github repo&nbsp;<a href="https://github.com/stephennancekivell/concordion_scala_samples">https://github.com/stephennancekivell/concordion_scala_samples</a><br /><br /><br /><span style="font-family: inherit;">Edit: It can also be done using Java bean properties. Thanks <a href="https://github.com/tom">Tom Malone</a>&nbsp;for explaining this.&nbsp;<span style="background-color: rgba(255, 255, 255, 0.917969); color: #222222;">ognl converts the #result.firstName to #result.getFirstName(). That wasnt clear while debugging.</span></span><br /><span style="background-color: rgba(255, 255, 255, 0.917969); color: #222222;"><span style="font-family: inherit;">So like this ..</span></span><br /><br /><blockquote class="tr_bq"><pre class="html" style="background-color: #ffffd9; border-bottom-color: rgb(237, 237, 223); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(237, 237, 223); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(237, 237, 223); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(237, 237, 223); border-top-style: solid; border-top-width: 1px; margin-left: 40px; padding-bottom: 8px; padding-left: 8px; padding-right: 8px; padding-top: 8px;"><span style="font-size: x-small;"><span style="font-family: 'Courier New', Courier, Fixed;"><span style="line-height: 18px;">&lt;span </span></span><b style="font-family: 'Courier New', Courier, Fixed; line-height: 18px;">concordion:execute="#result = split(#TEXT)"</b><span style="font-family: 'Courier New', Courier, Fixed;"><span style="line-height: 18px;">&gt;John Smith&lt;/span&gt;<br />                will be broken into first name<br />                &lt;span </span></span><b style="font-family: 'Courier New', Courier, Fixed; line-height: 18px;">concordion:assertEquals="#result.firstName"</b><span style="font-family: 'Courier New', Courier, Fixed;"><span style="line-height: 18px;">&gt;John&lt;/span&gt;<br />                and last name<br />                &lt;span </span></span><b style="font-family: 'Courier New', Courier, Fixed; line-height: 18px;">concordion:assertEquals="#result.lastName"</b><span style="font-family: 'Courier New', Courier, Fixed;"><span style="line-height: 18px;">&gt;Smith&lt;/span&gt;.</span></span></span></pre><a href="http://www.blogger.com/blogger.g?blogID=2519344180739427574" name="executeObjectResult" style="background-color: #fcfcfa;"></a></blockquote>Which will work with the following Scala case class.<br /><blockquote class="tr_bq"><span style="font-size: x-small;"><a href="http://www.blogger.com/blogger.g?blogID=2519344180739427574" name="executeObjectResult" style="background-color: #fcfcfa;"></a></span><br /><pre class="html" style="background-color: #ffffd9; border-bottom-color: rgb(237, 237, 223); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(237, 237, 223); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(237, 237, 223); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(237, 237, 223); border-top-style: solid; border-top-width: 1px; margin-left: 40px; padding-bottom: 8px; padding-left: 8px; padding-right: 8px; padding-top: 8px;"><span style="background-color: #ffffcc; line-height: 16px;"><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">case&nbsp;class&nbsp;result(@BeanProperty&nbsp;firstName:String,&nbsp;@BeanProperty&nbsp;lastName:String)</span></span></pre><div><span style="font-family: 'Courier New', Courier, Fixed; font-size: x-small;"><span style="line-height: 18px;"><br /></span></span></div><a href="http://www.blogger.com/blogger.g?blogID=2519344180739427574" name="executeObjectResult" style="background-color: #fcfcfa;"></a></blockquote>