---
layout: post
title: searchbrew.com
date: '2013-12-31T14:00:00.001-08:00'
author: Stephen Nancekivell
tags: 
modified_time: '2013-12-31T14:04:23.265-08:00'
thumbnail: http://2.bp.blogspot.com/-TY8SkjVEEfg/UsM9gMz6gkI/AAAAAAAABtI/Ld_jF69n_bY/s72-c/screenshot.png
blogger_id: tag:blogger.com,1999:blog-2519344180739427574.post-8317874791019477476
blogger_orig_url: http://blog.stephenn.com/2013/12/searchbrewcom.html
---

I made this website the other day.&nbsp;<a href="http://searchbrew.com/">searchbrew.com</a>&nbsp;This article about how I made it.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-TY8SkjVEEfg/UsM9gMz6gkI/AAAAAAAABtI/Ld_jF69n_bY/s1600/screenshot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="238" src="/assets/2013-12-31-searchbrewcom-screenshot.png" width="320" /></a></div><br /><br />Its a search for hombrew packages. Brew by itself doesnt have a very good search, because they dont want to collect description metadata about packages. Brew does have a link to the homepage of each package. I tried getting descriptions and indexing the homepage for search, but it didnt work very well. Then I came across this project&nbsp;<a href="https://github.com/telemachus/homebrew-desc">telemachus/homebrew-desc</a>&nbsp;which includes project descriptions. Homebrew-desc isnt always up to date, but its pretty good.<br /><br />The "all" link lists all packages and their descriptions which is good for spotting errors.<br /><br />Searchbrew.com gets its list of homebrew packages from the homebrew git repo, and the descriptions from homebrew-desc and puts it in elasticsearch. This updates periodically. When a user searches it just goes to elasticsearch.<br /><br />The elasticsearch query does a fuzzy search on all fields. Results from that were poor, where the exact match results wouldn't be first. I thought ES would favour that. I added a exact match query, results were better but often results where the term was in the description was ranked higher than where the term was in the title. I thought ES was supposed to favour shorter fields. So I added a match query on the title. Results were good. The ES query is bellow.<br /><br /><div style="text-align: left;">query: {</div><div style="text-align: left;">&nbsp; bool: {</div><div style="text-align: left;">&nbsp; &nbsp; should:&nbsp;</div><div style="text-align: left;">&nbsp; &nbsp; &nbsp; {query_string: {query: q~}},</div><div style="text-align: left;">&nbsp; &nbsp; &nbsp; {query_string: {query: q}},</div><div style="text-align: left;">&nbsp; &nbsp; &nbsp; {match: {title: q}}</div><div style="text-align: left;">&nbsp; &nbsp; ]</div><div style="text-align: left;">&nbsp; }</div><div style="text-align: left;">}</div><div style="text-align: left;"><br />At the moment Im happy with searchbrew, even though it data isn't perfect. There is some time between a new package getting added to homebrew and a description getting added to homebrew-desc. I could add some stuff to make it easier to add descriptions, maybe add some alerting. But for now its fine.</div>