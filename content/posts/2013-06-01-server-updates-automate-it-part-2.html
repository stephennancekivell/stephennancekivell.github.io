---
layout: post
title: 'Server updates: Email notifications and 1-click Apply.'
url: 2013/06/server-updates-automate-it-part-2.html
date: '2013-06-01T00:12:00.000-07:00'
author: Stephen Nancekivell
tags: 
modified_time: '2013-06-02T20:43:54.276-07:00'
thumbnail: http://1.bp.blogspot.com/-GKlRZcaE5O4/UawQ85QM6zI/AAAAAAAABkk/YF6pB1Q3DH0/s72-c/BLy5b5LCcAAqer9.png
blogger_id: tag:blogger.com,1999:blog-2519344180739427574.post-117190211573423884
blogger_orig_url: http://blog.stephenn.com/2013/06/server-updates-automate-it-part-2.html
---

These days Im getting update notifications via email, and now applying those updates with one click.<br /><br />I've had&nbsp;<a href="http://stephennancekivell.blogspot.co.nz/2011/07/server-updates-automate-it.html">email notifications for a while</a>, But lately I got annoyed that'd have to login to my server and run the `apt-get dist-upgrade` command. I noticed that I&nbsp;wasn't&nbsp;even doing it. I was just ignoring the updates, which is not good practice!<br /><br />So I've turned the 5minute job of logging in and applying the update into a 1 second job.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="/assets/2013-06-01-server-updates-automate-it-part-2-BLy5b5LCcAAqer9.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="282" src="/assets/2013-06-01-server-updates-automate-it-part-2-BLy5b5LCcAAqer9.png" width="320" /></a></div><br /><br />Heres how.<br /><br />I have a small python web server (using&nbsp;<a href="http://flask.pocoo.org/">flask</a>) which accepts the instruction to apply the update. The python web server is running as a user who has sudo access to run `apt-get dist-upgrade` (and only that =P). The result of which is then emailed back to me.<br /><br />I only want myself to be able to apply the updates. But if someone else did, its not that big a deal. I usually trust the ubuntu package maintainers. I really just want to watch the update happen incase it breaks and my server goes down. I dont require 100% uptime so this as an acceptable risk.<br /><br />The instruction is just a http get on a hidden url. Its has a 30 character hash in it. So its unlikely anyone is going to guess it, and if they do im going to the update results email.<br /><br />If I wanted to be a bit more secure about it, I could use a one time token for each update. But thats overkill for me.<br /><br />If there were a vulnerability in the web server and someone where able to execute&nbsp;arbitrary&nbsp;code the worst they could do is install the updates for me.<br /><br />Heres the code in a gist.<br /><a href="https://gist.github.com/stephennancekivell/5689547">https://gist.github.com/stephennancekivell/5689547</a>